- title: PowerShell_Downgrade_Attack
  id: 7efb052d-18ef-4f58-b5cb-6bdcde30fc29
  status: experimental
  description: |
    Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0
  references:
    - http://www.leeholmes.com/blog/2017/03/17/detecting-and-preventing-powershell-downgrade-attacks/
  author: Florian Roth (rule), Lee Holmes (idea)
  date: 2019-10-22
  logsource:
    category: Windows PowerShell
    product: PowerShell
  detection:
    selection:
      EventID: '400'
      Data2: 'EngineVersion=2.*'
    exclude:
      Data2: 'HostVersion=2.*'